using System.Text.Json.Serialization;

namespace ZentrixLabs.FalconSdk.Models;

/// <summary>
/// Represents the response for a vulnerability query.
/// </summary>
public class VulnerabilityQueryResponse
{
    /// <summary>
    /// Gets or sets the list of resources associated with the query.
    /// </summary>
    [JsonPropertyName("resources")]
    public List<string> Resources { get; set; } = [];

    /// <summary>
    /// Gets or sets the errors associated with the query, if any.
    /// </summary>
    [JsonPropertyName("errors")]
    public List<ApiError>? Errors { get; set; }

    /// <summary>
    /// Gets or sets the metadata associated with the query.
    /// </summary>
    [JsonPropertyName("meta")]
    public MetaInfo? Meta { get; set; }
}

/// <summary>
/// Represents metadata for a query response.
/// </summary>
public class MetaInfo
{
    [JsonPropertyName("pagination")]
    public PaginationInfo? Pagination { get; set; }
}

/// <summary>
/// Represents pagination information.
/// </summary>
public class PaginationInfo
{
    [JsonPropertyName("next_token")]
    public string? NextToken { get; set; }
}

/// <summary>
/// Represents an error returned by the API.
/// </summary>
public class ApiError
{
    [JsonPropertyName("code")]
    public string? Code { get; set; }

    [JsonPropertyName("message")]
    public string? Message { get; set; }
}
