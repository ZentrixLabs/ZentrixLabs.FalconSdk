using System;
using System.Collections.Generic;
using System.Text.Json.Serialization;

namespace ZentrixLabs.FalconSdk.Models;

/// <summary>
/// Represents a host with vulnerabilities as reported by CrowdStrike Spotlight.
/// </summary>
public class VulnerabilityHost
{
    /// <summary>
    /// The unique identifier (AID) of the host.
    /// </summary>
    [JsonPropertyName("aid")]
    public string Aid { get; set; } = string.Empty;

    /// <summary>
    /// The hostname of the device.
    /// </summary>
    [JsonPropertyName("hostname")]
    public string? Hostname { get; set; }

    /// <summary>
    /// The platform name (e.g., Windows, Linux).
    /// </summary>
    [JsonPropertyName("platform_name")]
    public string? PlatformName { get; set; }

    /// <summary>
    /// The operating system version.
    /// </summary>
    [JsonPropertyName("os_version")]
    public string? OsVersion { get; set; }

    /// <summary>
    /// The list of vulnerability IDs detected on this host.
    /// </summary>
    [JsonPropertyName("vulnerability_ids")]
    public List<string>? VulnerabilityIds { get; set; }

    /// <summary>
    /// The last time the host was seen by Spotlight.
    /// </summary>
    [JsonPropertyName("last_seen_timestamp")]
    public DateTimeOffset? LastSeenTimestamp { get; set; }
}